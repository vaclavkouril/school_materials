# plain-RSA
### Gen-RSA
Vstup: parametr $1^n$
Výstup: $N,e,d$
1. vygenerujme dostatečně velká prvočísla $p,q$ a spočteme $N$
2. spočteme $\phi(N) = (p-1)(q-1)$
3. vybereme $e>1$ takové aby $gcd(e,\phi(N)) = 1$
4. spočteme $d:= [e^{-1} \mod \phi(N)]$
5. vrátíme $N,e,d$

Klíče:
- veřejný: $(N,e)$
- soukromý: $(N,d)$

## Sign-RSA
Vstup: zpráva $m$
Výstup: zpráva a odpovídající podpis $(m,\sigma)$
1. spočteme $\sigma:= m^d \mod N$.
2. vrátíme $(m,\sigma)$

## Verify-RSA
Vstup: zpráva a podpis $(m,\sigma)$
Výstup: Ano pokud je validní podpis, Ne jinak
1. Zjistíme, zda se rovná $m \stackrel{\text{?}}{=} \sigma^e \mod N$
2. Vrátíme výsledek

# Plain RSA no message útok
1. Útočník vezme $(N,e)$
2. Zvolí náhodné $\sigma \in \mathbb{Z}_{N}^*$.
3. Spočte $m:= \sigma^e \mod N$.
4. Pošle Verify-RSA dvojici $(m,\sigma)$.
Verify-RSA ale vždy odpoví, že je to platný podpis, protože $m$ je přesně tak definováno.

# Oprava hash-RSA
Při podpisu uděláme $\sigma := H(m)^d \mod N$ a verifikace se dotáže na $H(m) = \sigma^e \mod N$.

---
# Consider a “padded RSA” signature scheme where the public key is $\langle N, e\rangle$ as usual, and a signature on a message $m \in \{0,1\}^l$ is computed by choosing uniform $r \in \{0,1\}^{2n-1}$ and outputting $[(r||m)^d \mod N ]$.
## a. How can verification be done for this scheme?

### Verify padded RSA:
Vstup: zpráva a podpis $(m,\sigma)$
Výstup: odpověď Ano/Ne dle platnosti podpisu
1. spočteme $s := \sigma^e \mod N$.
2. $s$ umíme rozdělit na $r'||m'$, kde $|m'| = l$ a $|r'| =2n -1$.
3. ověříme zda $m' = m$ a odpovíme $Ano$ pokud se rovnají, Ne jinak.

--- 
## b. Show that this scheme is insecure.

*Pozorování:* Verify neinteraguje s $r'$ a tedy z káždého $s$ si vytáhne jen relevantní $m'$ část. Padding nekontroluje a ani nemá jak kontrolovat z jaké distribuce se vzal padding, vždy pro verifikátor jen dojde **nějaký libovolný** padding.

To je vlastně to samé jako u Plain-RSA útoku, jen místo $m$ máme $r||m$.

### No-message forgery
1. Útočník vezme $(N,e)$
2. Zvolí náhodné $\sigma \in \mathbb{Z}_{N}^*$.
3. Spočte $y:= \sigma^e \mod N$.
4. Rozdělí $y = r' ||m'$
5. Útočník vypíše $(m',\sigma)$ jako podpis na zprávě $m'$.
##### Ověření
- Verifikátor spočte $s = \sigma^e \mod N$ a to je totéž co $y$.
- Rozdělí $y' =r''||m''$. Rozdělení je deterministické a stejné, takže $r'=r'', m'=m''$.
- Ověří $m' = m''$, což platí.
- Verifikace tedy vždy vrátí 1.