# Hopcroft-Karp
V bipartitních grafech maximální párování m velikost stejnou jako vrcholové pokrytí a máme poly alg. $O(m\sqrt{ n })$

Definice: Korunní rozklad $G$ je $V = C \dot{\cup} H\dot{\cup}R$, kde 
1. $H \neq \emptyset$,
2. $C$ je nezávislá,
3. mezi $C$ a $R$ nevede hrana,
4. $G$ obsahuje párování mezi $H,C$ velikosti $H$.

Lemma: Pro $G$  $|V| \geq 3k+1$ existuje algortimus, který buď najde párování velikosti $\geq k+1$, nebo máme nějaký horní odhad.

DK: 
1. hladově najdeme maximální párování (nepřidatelná další hrana) $N$,předpokladem je $|M| \leq k$, jinak NE, tedy $V \setminus N$ je nezávislá množina $I$, kde $E'$ jsou hrany z $I$ do $N$.
	$E'$ indukuje bip. graf
2. najdeme největší párování $G|_{E'}$ a spojující VC $X$, jménem $M'$, předpokladem je $|M'| = |X| \leq k$, jinak NE. Protože $|X|< |I| \land X \nsubseteq I$, $\implies X \cap V_{M} \neq \emptyset$.
3. Zvolíme $H := X \cap V_{M}$, $C := V_{M'} \cap I$, $R$ je zbytkem
Zbývá bod 3. definice, $C$ do $X$ nic společného nemají
$W \subset C \Rightarrow v \in V_{M}$, HopcroftKarp $\Rightarrow v \not\in X$, hrana $vw$ by musela být pokryta $X$, takže $v \in X \Rightarrow v \in X \cap V_{M} \Rightarrow v \in H \Rightarrow \in R$ spor

Použití $G$, búno bez izolovaných vrcholů a má-li $\geq 3k+1$ vrcholů, tak aplikujeme lemma a máme NE, nebo $(H,C,R)$ $\implies$ velikost $\leq3k$.

Korektnost: musíme alespoň $|H|$ vrcholů 

---
LP pro VC má řešení (v pol. čase) s hodnotami řešení $\{ 0,1, 1/2 \}$
$H = (V_{1} \times V_{2}, E')$ - bip., párování $M'$ v poly čase -> ILP řešení
-> LP v $G$, průměr z $H$, $X_v =\frac{1}{2} (x_{v_{1}} + x_{v_{2}})$.
Optimalita nechť $y$ je nějaké optimum LP v $G$. Zadefinujeme řešení $z$ na $H: z_{v_{1}} = y_{v_{1}}$, z je přípustné řešení
$$
\sum_{v \in V_{1}} y_{v} = \frac{1}{2} \sum_{} (z_{v_{2}} +z_{v_{2}}).
$$
$$
|M|=\sum_{v \in G\text{, pokud } v \in M}\frac{1}{2} (y_{v_{2}} +y_{v_{2}}) = \sum_{v \in V_{1}} x_{v}.
$$
$$
\sum_{v \in V_{1}} y_{v} = \frac{1}{2} \sum_{} (z_{v_{2}} +z_{v_{2}}) \geq \frac{1}{2} \sum_{(v_{1},v_{2}) \in M} (z_{v_{2}} +z_{v_{2}}) 
$$
Mějme $S$ jako vertex cover v $H$, $|S| = |H|$
$$
\frac{1}{2} \sum_{(v_{1},v_{2}) \in M} (z_{v_{2}} +z_{v_{2}}) \geq \frac{1}{2}|M| = \frac{1}{2} |S| = \sum x_{v}.
$$


Dokončení: Dáme $G, k$ vyřešíme půlkový LP, a rozdělí vrcholy dle hodnoto a zúžíme problematiku na vrcholy co mají polovinky a $0,1$ jsou součástí VC. 